<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>早押しクイズ（選択形式）</title>
    <script src="/socket.io/socket.io.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <h1>早押しクイズ（選択形式）</h1>
    
    <div>
        <input type="text" id="roomName" placeholder="ルーム名">
        <input type="text" id="playerName" placeholder="プレイヤー名">
        <button id="joinRoomButton">ルームに参加</button>
    </div>
    
    <div id="quiz" style="display: none;">
        <h2 id="question">問題がここに表示されます</h2>
        <div id="choices"></div>
        <div id="timer">残り時間: <span id="timeLeft">30</span> 秒</div>
        <div id="messages"></div>
        <div id="scores">
            <h3>プレイヤースコア</h3>
            <ul id="scoreList"></ul>
        </div>
    </div>

    <div id="playerList" style="display: none;">
        <h3>参加プレイヤー</h3>
        <ul id="players"></ul>
        <button id="readyButton">準備完了</button>
    </div>

    <script>
        const socket = io();
        const roomNameInput = document.getElementById("roomName");
        const playerNameInput = document.getElementById("playerName");
        const joinRoomButton = document.getElementById("joinRoomButton");
        const questionElement = document.getElementById("question");
        const choicesElement = document.getElementById("choices");
        const messages = document.getElementById("messages");
        const timeLeftElement = document.getElementById("timeLeft");
        const scoreList = document.getElementById("scoreList");
        const playersList = document.getElementById("players");
        const readyButton = document.getElementById("readyButton");

        let currentRoom = null;

        // プレイヤー名にログインIDを設定
        document.addEventListener("DOMContentLoaded", () => {
            const username = localStorage.getItem("username");
            if (username) {
                playerNameInput.value = username;
                playerNameInput.disabled = true; // プレイヤー名を変更不可に
            } else {
                alert("ログイン情報がありません。ログイン画面に戻ります。");
                window.location.href = "/";
            }
        });

        // ルームに参加
        joinRoomButton.addEventListener("click", () => {
            const roomName = roomNameInput.value.trim();
            const playerName = playerNameInput.value.trim();

            if (roomName && playerName) {
                currentRoom = roomName;
                socket.emit("join_room", roomName, playerName);

                document.getElementById("quiz").style.display = "block";
                document.getElementById("playerList").style.display = "block";
            }
        });

        // クイズ関連のSocket.ioロジック（省略）
    </script>
</body>
</html>
